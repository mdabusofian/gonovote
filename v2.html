<!DOCTYPE html>
<html lang="bn">
<head>
  <meta charset="UTF-8">
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Hind+Siliguri:wght@300;400;600;700&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Hind Siliguri', sans-serif; background: #f0f2f5; }
    .glass-effect { background: rgba(255, 255, 255, 0.9); backdrop-filter: blur(10px); }
    .card-shadow { box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.05), 0 8px 10px -6px rgba(0, 0, 0, 0.05); }
    .gradient-bg { background: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 100%); }
    .loader { border-top-color: #3b82f6; animation: spinner 1.5s linear infinite; }
    @keyframes spinner { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
  </style>
</head>
<body class="min-h-screen pb-10">

  <div class="gradient-bg text-white pb-24 pt-10 px-6 text-center">
    <h1 class="text-3xl font-bold mb-2">ভোটার তথ্য অনুসন্ধান</h1>
    <p class="opacity-80">দৌলতপুর (৩ নং ওয়ার্ড অংশ) - নির্বাচনী ডিজিটাল বুথ</p>
  </div>

  <div class="max-w-md mx-auto -mt-16 px-4">
    <div class="glass-effect rounded-2xl p-6 card-shadow border border-white">
      <div class="relative">
        <input type="text" id="searchInput" 
               class="w-full pl-4 pr-12 py-4 bg-gray-50 border-2 border-gray-100 rounded-xl focus:border-blue-500 focus:outline-none transition-all text-lg" 
               placeholder="নাম বা বাড়ির নাম লিখুন...">
        <button onclick="handleSearch()" class="absolute right-3 top-3 bg-blue-600 text-white p-2 rounded-lg hover:bg-blue-700 transition">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
          </svg>
        </button>
      </div>
      <p class="text-xs text-center text-gray-500 mt-3">কমপক্ষে ২ অক্ষর লিখে অনুসন্ধান করুন</p>
    </div>
  </div>

  <div id="results" class="max-w-xl mx-auto mt-8 px-4 space-y-4">
    </div>

  <div id="loader" class="hidden flex justify-center mt-10">
    <div class="loader ease-linear rounded-full border-4 border-t-4 border-gray-200 h-12 w-12"></div>
  </div>

  <script>
    function handleSearch() {
      const query = document.getElementById('searchInput').value;
      if (query.length < 2) return;

      document.getElementById('results').innerHTML = '';
      document.getElementById('loader').classList.remove('hidden');

      google.script.run.withSuccessHandler(renderResults).searchVoter(query);
    }

    function renderResults(data) {
      document.getElementById('loader').classList.add('hidden');
      const container = document.getElementById('results');
      
      if (data.length === 0) {
        container.innerHTML = `<div class="text-center py-10 text-gray-500 bg-white rounded-xl">কোনো তথ্য খুঁজে পাওয়া যায়নি!</div>`;
        return;
      }

      data.forEach(voter => {
        const card = `
          <div class="bg-white rounded-2xl p-5 card-shadow border border-gray-50 transition-transform active:scale-95">
            <div class="flex justify-between items-start mb-3">
              <div>
                <span class="text-xs font-bold text-blue-600 uppercase tracking-wider">সিরিয়াল নাম্বার</span>
                <div class="text-3xl font-black text-red-600">${voter.serial}</div>
              </div>
              <div class="text-right">
                <span class="bg-blue-50 text-blue-700 px-3 py-1 rounded-full text-xs font-semibold">ভোটার নং: ${voter.voterNo.toString().slice(-4)}</span>
              </div>
            </div>
            
            <h3 class="text-xl font-bold text-gray-800 mb-2">${voter.name}</h3>
            
            <div class="grid grid-cols-1 gap-1 text-sm text-gray-600 border-t pt-3">
              <p><strong>পিতা:</strong> ${voter.father}</p>
              <p><strong>মাতা:</strong> ${voter.mother}</p>
              <p><strong>ঠিকানা:</strong> ${voter.address}</p>
              <p class="mt-2 text-xs text-gray-400 font-mono">DOB: ${voter.dob}</p>
            </div>
          </div>
        `;
        container.innerHTML += card;
      });
    }

    // Enter key support
    document.getElementById('searchInput').addEventListener("keyup", function(event) {
      if (event.key === "Enter") handleSearch();
    });
  </script>
</body>
</html>
